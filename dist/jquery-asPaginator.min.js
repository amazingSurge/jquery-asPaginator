/*! asPaginator - v0.1.0 - 2014-03-28
* https://github.com/amazingSurge/jquery-asPaginator
* Copyright (c) 2014 amazingSurge; Licensed GPL */
(function(t){var e=t.paginator=function(a,n,i){this.element=a,this.$element=t(a).empty(),this.options=t.extend({},e.defaults,i),this.namespace=this.options.namespace,this.currentPage=this.options.currentPage||1,this.itemsPerPage=this.options.itemsPerPage,this.totalItems=n,this.totalPages=this.getTotalPages(),this.isOutOfBounds()&&(this.currentPage=this.totalPages),this.initialized=!1,this.components=t.extend(!0,{},this.components),this.$element.addClass(this.namespace),this.options.skin&&this.$element.addClass(this.namespace+"_"+this.options.skin),this.trigger("init"),this.init()};e.prototype={constructor:e,components:{},init:function(){var e=this,a='<li class="'+e.namespace+"-prev"+'"><a></a></li>',n='<li class="'+e.namespace+"-next"+'"><a></a></li>';e.$wrap=t('<ul class="'+e.namespace+"-basic"+'"></ul>'),e.$prev=t(a).find("a").html(e.options.prevText).end().appendTo(e.$wrap),e.$next=t(n).find("a").html(e.options.nextText).end().appendTo(e.$wrap),e.$prev.on("click.asPaginator",t.proxy(e.prev,e)),e.$next.on("click.asPaginator",t.proxy(e.next,e)),e.$wrap.appendTo(e.$element),t.each(this.options.components,function(t,a){return null===a||a===!1?!1:(e.components[t].init.call(e.components[t],e),void 0)}),e.goTo(e.currentPage),e.initialized=!0,this.trigger("ready")},calculate:function(t,e,a){var n=1,i=1;return a+2>=t&&(n=0),t+a+2>=e&&(i=0),{left:n,right:i}},trigger:function(t){this.$element.trigger("asPaginator::"+t,this),t=t.replace(/\b\w+\b/g,function(t){return t.substring(0,1).toUpperCase()+t.substring(1)});var e="on"+t,a=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;"function"==typeof this.options[e]&&this.options[e].apply(this,a)},goTo:function(t){var t=Math.max(1,Math.min(t,this.totalPages));return t===this.currentPage&&this.initialized===!0?!1:(this.$next.add(this.$prev).removeClass(this.namespace+"_disable"),t===this.totalPages&&this.$next.addClass(this.namespace+"_disable"),1===t&&this.$prev.addClass(this.namespace+"_disable"),this.currentPage=t,this.initialized&&this.trigger("change",t),void 0)},prev:function(){return this.hasPreviousPage()?(this.goTo(this.getPreviousPage()),!0):!1},next:function(){return this.hasNextPage()?(this.goTo(this.getNextPage()),!0):!1},goFirst:function(){return this.goTo(1)},goLast:function(){return this.goTo(this.totalPages)},update:function(t,e){var a={};"string"==typeof t?a[t]=e:a=t;for(var n in a)switch(n){case"totalItems":this.totalItems=a[n];break;case"itemsPerPage":this.itemsPerPage=a[n];break;case"currentPage":this.currentPage=a[n]}this.totalPages=this.totalPages()},isOutOfBounds:function(){return this.currentPage>this.totalPages},getItemsPerPage:function(){return this.itemsPerPage},getTotalItems:function(){return this.totalItems},getTotalPages:function(){return this.totalPages=Math.ceil(this.totalItems/this.itemsPerPage),this.lastPage=this.totalPages,this.totalPages},getCurrentPage:function(){return this.currentPage},hasPreviousPage:function(){return this.currentPage>1},getPreviousPage:function(){return this.hasPreviousPage()?this.currentPage-1:!1},hasNextPage:function(){return this.currentPage<this.totalPages},getNextPage:function(){return this.hasNextPage()?this.currentPage+1:!1}},e.defaults={namespace:"asPaginator",prevText:"prev",nextText:"next",currentPage:1,itemsPerPage:10,adjacentNum:3,skin:null,components:{lists:!0},onInit:null,onReady:null,onChange:null},e.registerComponent=function(t,a){e.prototype.components[t]=a},e.registerComponent("lists",{defaults:{fix:!1,displayPages:5,tpl:'<li><a href="#"></a></li>'},init:function(e){var a=t.extend({},this.defaults,e.options.components.lists),n=this;this.opts=a,a.fix===!1?(e.$wrap.delegate("li","click",function(a){var n=t(a.target).parent().data("value");return void 0===n?!1:"omit"===n?!1:""===n?!1:(e.goTo(n),void 0)}),n.render(e),e.$element.on("asPaginator::change",function(){n.render(e)})):(e.$wrap.delegate("li","click",function(a){var n=t(a.target).parent().data("value");return void 0===n?!1:""===n?!1:(e.goTo(n),!1)}),n.fixRender(e),e.$element.on("asPaginator::change",function(){n.fixRender(e)}))},render:function(e){var a=e.currentPage,n=e.totalPages,i=e.options.adjacentNum,s=e.calculate(a,n,i),r="";if(0===s.left){for(var o=1;a-1>=o;o++)r+='<li data-value="'+o+'"><a href="#">'+o+"</a></li>";r+='<li class="'+e.namespace+'_active" data-value="'+a+'"><a href="#">'+a+"</a></li>"}else{for(var o=1;2>=o;o++)r+='<li data-value="'+o+'"><a href="#">'+o+"</a></li>";r+='<li class="'+e.namespace+'_omit" data-value="omit"><a href="#">...</a></li>';for(var o=a-i;a-1>=o;o++)r+='<li data-value="'+o+'"><a href="#">'+o+"</a></li>";r+='<li class="'+e.namespace+'_active" data-value="'+a+'"><a href="#">'+a+"</a></li>"}if(0===s.right)for(var o=a+1;n>=o;o++)r+='<li data-value="'+o+'"><a href="#">'+o+"</a></li>";else{for(var o=a+1;a+i>=o;o++)r+='<li data-value="'+o+'"><a href="#">'+o+"</a></li>";r+='<li class="'+e.namespace+'_omit" data-value="omit"><a href="#">...</a></li>';for(var o=n-1;n>=o;o++)r+='<li data-value="'+o+'"><a href="#">'+o+"</a></li>"}e.$wrap.find("li").not("."+e.namespace+"-prev").not("."+e.namespace+"-next").remove(),e.$prev.after(t(r))},fixRender:function(e){var a,n=e.currentPage,i=this.opts.displayPages-1,s="",r=e.$wrap.find("li").removeClass(e.namespace+"_active");if(t.each(r,function(i,s){return t(s).data("value")===n?(t(s).addClass(e.namespace+"_active"),a=!1,!1):void 0}),a!==!1){s+='<li class="'+e.namespace+'_active" data-value="'+n+'"><a href="#">'+n+"</a></li>";for(var o=n+1,l=o+i-1>e.totalPages?e.totalPages:o+i-1;l>=o;o++)s+='<li data-value="'+o+'"><a href="#">'+o+"</a></li>";e.$wrap.find("li").not("."+e.namespace+"-prev").not("."+e.namespace+"-next").remove(),e.$prev.after(t(s))}}}),e.registerComponent("goTo",{defaults:{text:"Go"},init:function(e){var a=t.extend({},this.defaults,e.options.components.goTo),n=t('<div class="'+e.namespace+'-goto"><input type="text" /><span></span></div>'),i=n.find("input"),s=n.find("span").text(a.text);e.$element.append(n),s.on("click",function(){var t=parseInt(i.val());e.goTo(t)})}}),e.registerComponent("info",{init:function(e){var a=(t.extend({},this.defaults,e.options.components.info),t('<div class="'+e.namespace+'-info"><span class="'+e.namespace+'-current"></span>/<span class="'+e.namespace+'-total"></span></div>')),n=a.find("."+e.namespace+"_current");a.find("."+e.namespace+"-total").text(e.totalPages),n.text(e.currentPage),e.$element.append(a).on("asPaginator::change",function(){n.text(e.currentPage)})}}),t.fn.asPaginator=function(a,n){if("string"==typeof n){var i=n,s=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var e=t.data(this,"asPaginator");"function"==typeof e[i]&&e[i].apply(e,s)})}return a===void 0?this:this.each(function(){t.data(this,"asPaginator")||t.data(this,"asPaginator",new e(this,a,n))})}})(jQuery);