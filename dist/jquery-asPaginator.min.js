/*! jQuery asPaginator - v0.1.3 - 2015-03-11
* https://github.com/amazingSurge/jquery-asPaginator
* Copyright (c) 2015 amazingSurge; Licensed GPL */
!function(a){"use strict";var b=function(c,d,e){this.element=c,this.$element=a(c).empty(),this.options=a.extend({},b.defaults,e),this.namespace=this.options.namespace,this.currentPage=this.options.currentPage||1,this.itemsPerPage=this.options.itemsPerPage,this.totalItems=d,this.totalPages=this.getTotalPages(),this.isOutOfBounds()&&(this.currentPage=this.totalPages),this.initialized=!1,this.components=a.extend(!0,{},this.components),this.$element.addClass(this.namespace),this.options.skin&&this.$element.addClass(this.namespace+"_"+this.options.skin),this.classes={disabled:this.namespace.disabledClass,active:this.namespace.activeClass},this.disabled=!1,this._trigger("init"),this.init()};b.prototype={constructor:b,components:{},init:function(){var b=this;b.$wrap=b.options.wrap?a(b.options.wrap):b.$element,b.$first=a(b.options.first).appendTo(b.$wrap),b.$prev=a(b.options.prev).appendTo(b.$wrap),b.$next=a(b.options.next).appendTo(b.$wrap),b.$last=a(b.options.last).appendTo(b.$wrap),b.$wrap.appendTo(b.$element),b.bindEvents(),b.goTo(b.currentPage),b.initialized=!0,this.options.responsive&&a(window).on("resize",this._throttle(function(){b.resize.call(b)},250)),this._trigger("ready")},bindEvents:function(){var b=this;b.$first.on("click.asPaginator",a.proxy(b.goFirst,b)),b.$prev.on("click.asPaginator",a.proxy(b.prev,b)),b.$next.on("click.asPaginator",a.proxy(b.next,b)),b.$last.on("click.asPaginator",a.proxy(b.goLast,b)),a.each(this.options.components,function(a,c){return null===c||c===!1?!1:void b.components[a].init.call(b.components[a],b)})},unbindEvents:function(){var b=this;b.$first.off("click.asPaginator"),b.$prev.off("click.asPaginator"),b.$next.off("click.asPaginator"),b.$last.off("click.asPaginator"),a.each(this.options.components,function(a,c){return null===c||c===!1?!1:void b.components[a].unbindEvents.call(b.components[a],b)})},resize:function(){var b=this;b._trigger("resize"),b.goTo(b.currentPage),a.each(this.options.components,function(a,c){return null===c||c===!1?!1:void b.components[a].resize.call(b.components[a],b)})},_throttle:function(a,b){var c,d,e,f=Date.now||function(){return(new Date).getTime()},g=null,h=0,i=function(){h=f(),g=null,e=a.apply(c,d),c=d=null};return function(){var j=f(),k=b-(j-h);return c=this,d=arguments,0>=k?(clearTimeout(g),g=null,h=j,e=a.apply(c,d),c=d=null):g||(g=setTimeout(i,k)),e}},calculate:function(a,b,c){var d=1,e=1;return c+2>=a&&(d=0),a+c+1>=b&&(e=0),{left:d,right:e}},_trigger:function(a){var b=Array.prototype.slice.call(arguments,1),c=[this].concat(b);this.$element.trigger("asPaginator::"+a,c),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var d="on"+a;"function"==typeof this.options[d]&&this.options[d].apply(this,b)},goTo:function(a){return a=Math.max(1,Math.min(a,this.totalPages)),a===this.currentPage&&this.initialized===!0?!1:(this.$next.add(this.$prev).add(this.$first).add(this.$last).removeClass(this.namespace+"_disable"),a===this.totalPages&&this.$next.add(this.$last).addClass(this.namespace+"_disable"),1===a&&this.$prev.add(this.$first).addClass(this.namespace+"_disable"),this.currentPage=a,void(this.initialized&&this._trigger("change",a)))},prev:function(){return this.hasPreviousPage()?(this.goTo(this.getPreviousPage()),!0):!1},next:function(){return this.hasNextPage()?(this.goTo(this.getNextPage()),!0):!1},goFirst:function(){return this.goTo(1)},goLast:function(){return this.goTo(this.totalPages)},update:function(a,b){var c={};"string"==typeof a?c[a]=b:c=a;for(var d in c)switch(d){case"totalItems":this.totalItems=c[d];break;case"itemsPerPage":this.itemsPerPage=c[d];break;case"currentPage":this.currentPage=c[d]}this.totalPages=this.totalPages()},isOutOfBounds:function(){return this.currentPage>this.totalPages},getItemsPerPage:function(){return this.itemsPerPage},getTotalItems:function(){return this.totalItems},getTotalPages:function(){return this.totalPages=Math.ceil(this.totalItems/this.itemsPerPage),this.lastPage=this.totalPages,this.totalPages},getCurrentPage:function(){return this.currentPage},hasPreviousPage:function(){return this.currentPage>1},getPreviousPage:function(){return this.hasPreviousPage()?this.currentPage-1:!1},hasNextPage:function(){return this.currentPage<this.totalPages},getNextPage:function(){return this.hasNextPage()?this.currentPage+1:!1},enable:function(){this.disabled&&(this.disabled=!1,this.$element.removeClass(this.classes.disabled),this.bindEvents())},disable:function(){this.disabled!==!0&&(this.disabled=!0,this.$element.addClass(this.classes.disabled),this.unbindEvents())},destory:function(){this.$element.removeClass(this.classes.disabled),this.unbindEvents(),this.$element.data("asPaginator",null),this._trigger("destory")}},b.defaults={namespace:"asPaginator",wrap:'<ul class="asPaginator-basic"></ul>',first:'<li class="asPaginator-first"><a>First</a></li>',prev:'<li class="asPaginator-prev"><a>Prev</a></li>',next:'<li class="asPaginator-next"><a>Next</a></li>',last:'<li class="asPaginator-last"><a>Last</a></li>',currentPage:1,itemsPerPage:10,visibleNum:5,responsive:!1,disabledClass:"disabled",activeClass:"active",skin:null,components:{lists:!0},onInit:null,onReady:null,onChange:null},b.registerComponent=function(a,c){b.prototype.components[a]=c},b.registerComponent("lists",{defaults:{fix:!1,tpl:function(a,b){return"omit"===b?'<li class="class="asPaginator_omit" data-value="omit"><a href="#">...</a></li>':"<li "+(b?'class="asPaginator_'+b+'"':"")+' data-value="'+a+'"><a href="#">'+a+"</a></li>"}},init:function(b){var c=a.extend({},this.defaults,b.options.components.lists);this.opts=c,this.bindEvents(b)},bindEvents:function(b){var c=this;b.$wrap.on("click",b.$wrap.children(),function(d){var e=a(d.target).parent().data("value")||a(d.target).data("value");return void 0===e?!1:"omit"===e&&c.opts.fix===!1?!1:""===e?!1:void b.goTo(e)}),c.opts.fix===!1?(c.render(b),b.$element.on("asPaginator::change",function(){c.render(b)})):(c.fixRender(b),b.$element.on("asPaginator::change",function(){c.fixRender(b)}))},unbindEvents:function(a){a.$wrap.off("click",a.$wrap.children())},resize:function(a){this.opts.fix===!1?this.render(a):this.fixRender(a)},getVisible:function(b){var c=b.$element.width(),d=0;return b.options.responsive.visibleNum?a.each(b.options.responsive.visibleNum,function(a,b){c>b[0]&&(d=b[1])}):d=b.options.visibleNum,d},render:function(b){var c,d=b.currentPage,e=b.totalPages,f=this.getVisible(b),g=b.calculate(d,e,f),h="";if(0===g.left){for(c=1;d-1>=c;c++)h+=this.opts.tpl(c);h+=this.opts.tpl(d,"active")}else{for(c=1;2>=c;c++)h+=this.opts.tpl(c);for(h+=this.opts.tpl(d,"omit"),c=d-f+1;d-1>=c;c++)h+=this.opts.tpl(c);h+=this.opts.tpl(d,"active")}if(0===g.right)for(c=d+1;e>=c;c++)h+=this.opts.tpl(c);else{for(c=d+1;d+f-1>=c;c++)h+=this.opts.tpl(c);for(h+=this.opts.tpl(d,"omit"),c=e-1;e>=c;c++)h+=this.opts.tpl(c)}b.$wrap.children().not("."+b.namespace+"-prev").not("."+b.namespace+"-next").not("."+b.namespace+"-first").not("."+b.namespace+"-last").remove(),b.$prev.after(a(h))},fixRender:function(b){var c,d=b.currentPage,e=this.getVisible(b),f="",g=b.$wrap.children().removeClass(b.namespace+"_active");if(a.each(g,function(e,f){return a(f).data("value")===d?(a(f).addClass(b.namespace+"_active"),c=!1,!1):void 0}),c!==!1||this.visibleBefore!==e){this.visibleBefore=e;var h=d>=e?d%e:d;h=0===h?e:h;for(var i=1;h>i;i++)f+=this.opts.tpl(d-h+i);f+=this.opts.tpl(d,"active");for(var j=d+1,k=j+e-h-1>b.totalPages?b.totalPages:j+e-h-1;k>=j;j++)f+=this.opts.tpl(j);b.$wrap.children().not("."+b.namespace+"-prev").not("."+b.namespace+"-next").not("."+b.namespace+"-first").not("."+b.namespace+"-last").remove(),b.$prev.after(a(f))}}}),b.registerComponent("goTo",{defaults:{wrap:'<div class="asPaginator-goto"></div>',input:'<input type="text" />',button:'<button type="submit">Go</button>'},init:function(b){var c=a.extend({},this.defaults,b.options.components.goTo);this.$goTo=a(c.wrap),this.$input=a(c.input),this.$button=a(c.button),this.$goTo.append(this.$input).append(this.$button),b.$element.append(this.$goTo),this.bindEvents(b)},bindEvents:function(a){var b=this;b.$button.on("click",function(){var c=parseInt(b.$input.val(),10);c=c>0?c:a.currentPage,a.goTo(c)})},unbindEvents:function(){this.$goTo.off("click",this.$button)}}),b.registerComponent("info",{defaults:{tpl:function(){return'<li class="asPaginator-info"><a href="javascript:void(0);"><span class="asPaginator-current"></span> / <span class="asPaginator-total"></span></a></li>'}},init:function(b){var c=a.extend({},this.defaults,b.options.components.info),d=a(c.tpl()),e=d.find("."+b.namespace+"-current");d.find("."+b.namespace+"-total").text(b.totalPages),b.$prev.after(d),e.text(b.currentPage),b.$element.on("asPaginator::change",function(){e.text(b.currentPage)})}}),a.fn.asPaginator=function(c,d){if("string"==typeof d){var e=d,f=Array.prototype.slice.call(arguments,1);return this.each(function(){var b=a.data(this,"asPaginator");"function"==typeof b[e]&&b[e].apply(b,f)})}return"undefined"==typeof c?this:this.each(function(){a.data(this,"asPaginator")||a.data(this,"asPaginator",new b(this,c,d))})}}(jQuery);